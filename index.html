<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>球員成績表（含照片）</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background-color: #f4f4f4;
    }
    img {
      max-width: 80px;
      height: auto;
      border-radius: 6px;
    }
    .no-image {
      color: #aaa;
    }
  </style>
</head>
<body>
  <h2>球員成績表（含照片）</h2>
  <table id="playerTable">
    <thead>
      <tr>
        <th>背號</th>
        <th>照片</th>
        <th>姓名</th>
        <th>安打數</th>
        <th>打數</th>
        <th>打擊率</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const csvUrl = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQG-3TToygmpU9ISirmKzyTHEtFdvP9OUpFRSpB-kzPQCNYlkywx1XEHOqcVwhOdibujEhds8sl1Sim/pub?output=csv";

    // 照片對照表
    const photoMap = {
      "逸宏": "https://raw.githubusercontent.com/samyoung621/test/main/DSC02735.jpeg"
    };

    fetch(csvUrl)
      .then(response => response.text())
      .then(data => {
        const rows = data.split("\n").map(r => r.split(","));
        const tbody = document.querySelector("#playerTable tbody");

        rows.slice(1).forEach(row => {
          if (row.length < 5) return;

          const tr = document.createElement("tr");

          const num = row[0];
          const name = row[2];
          const hits = row[3];
          const atBats = row[4];
          const avg = row[5];

          // 照片欄位
          let photoHtml = "";
          if (photoMap[name]) {
            photoHtml = `<img src="${photoMap[name]}" alt="${name}" onerror="this.replaceWith(document.createTextNode('No Image'))">`;
          } else {
            photoHtml = '<span class="no-image">No Image</span>';
          }

          tr.innerHTML = `
            <td>${num}</td>
            <td>${photoHtml}</td>
            <td>${name}</td>
            <td>${hits}</td>
            <td>${atBats}</td>
            <td>${avg}</td>
          `;

          tbody.appendChild(tr);
        });
      });
  </script>
</body>
</html>